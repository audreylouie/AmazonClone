<!DOCTYPE html>
<html>
  <head>
    <title>lesson 18 exercise</title>
  </head>
  <body>
    <script>
    const xhr = new XMLHttpRequest();
    xhr.addEventListener('load', () => {
      console.log(xhr.response);
    });
    xhr.open('GET','https://supersimplebackend.dev/greeting');
    xhr.send();

    fetch('https://supersimplebackend.dev/greeting').then((response) => {
      return response.text();
    }).then((response) => {
      console.log(response);
    });
     
    async function greeting () {
      const response = await fetch('https://supersimplebackend.dev/greeting');
      const text = await response.text();
      console.log(text);
    }
    greeting();

   async function postGreeting () {
    const response = await fetch ('https://supersimplebackend.dev/greeting', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        name: 'Audrey'
      })
    });
    const text = await response.text();
    console.log(text);
   }
   postGreeting();

   async function amazon(){
    try{
      const response = await fetch ('https://amazon.com');
      const text = await response.text();
      console.log(text);
    }
    catch(error){
      console.log('CORS error. Your request was blocked by backend.')
    }
   }
   amazon();

   async function posterror() {
    try{
      const response = await fetch('https://supersimplebackend.dev/greeting', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    });
    if (response.status >= 400){
      throw response;
    }
    const text = await response.text();
    console.log(text);
    }
   
    catch(error){
      if(error.status === 400){
      const errorMessage = await error.json();
      console.log(errorMessage);
    }else{
      console.log('Network error. Please try again later.');
    }
     
    }
   }
   posterror();
    </script>
  </body>
</html>